module AlexaMessagesSpec where


import Test.Hspec(Spec, it, shouldBe, describe)
import AWS.AWSTypes.AlexaMessages
import AWS.AWSTypes.AlexaContext
import Data.Aeson
import Data.Either(isRight)

spec :: Spec
spec = do
    describe "Prelude.head" $ do
        it "can parse a message without geographic authorization" $ do
            let d = "{\"context\":{\"Extensions\":{\"available\":{}},\"System\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"device\":{\"supportedInterfaces\":{},\"deviceId\":\"amzn1.ask.device.AFYC4KAHCGLJHYPRE2YGGQJI4YNQ2262L2YIPWOWGC6Z4E6QP34DDLRSK5IMURCW5ZHQMX66SQDGARUO4D2B3KVY7HVAH3IV7YQG5DYRLLRU6ACWSRWM4T2QQLYJBF2YWZSPCOFPL2DFJERALTWMT6EO3XDB7HQI3YFYW7E3WRLJYJBTWF74M\"},\"apiEndpoint\":\"https://api.eu.amazonalexa.com\",\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"DENIED\"}}}},\"apiAccessToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTY0NTY5NCwiaWF0IjoxNjExNjQ1Mzk0LCJuYmYiOjE2MTE2NDUzOTQsInByaXZhdGVDbGFpbXMiOnsiY29udGV4dCI6IkFBQUFBQUFBQVFCVjI1TlB4U2o3cUUyZ3JFMlR1Tit0S2dFQUFBQUFBQURkN29zN2w5M1pLUEYweTA5UE8zVjc1YllvbkxZcGdJRHF0akZaSEVUTVRBQ3ZOait1TGRJckxSUTlaRWNja3ZES01aTyswdUZuaFljOEhEa1Jjd2ZiQ09GcmppaFhLRUtHbUxFNUIzQm5lTHk3SzFPTzJ0aU9yQ0JBL045NTQ4UGRTdmZnc25MQkMrOWlQZVdFYXo5MEtKeVBVU1J0aGRIVGx6OUNBSmYxMWk4UFdScGRVSDE1bHJYVmorM1VOMHpUSmh6U3pUdVNCU0NFeWM4R1Q2K2FjWHJhenljNXFrMG02MDgrUGhxRlBMZHlXbkdVTnlQaGIvcVl1L3BuL2lqRVJ4WTdEQ0tUMG1vMEp0MjNtOFB5VGpSQXM5S3pKQ3lKOHJPWTJHNkplNkt1SjhFeEMxemZ0UU41UlFZWURrWld0ZWthMlhIUnhGY0FFQkFCZDZMaWttU0ttZng2MjlZcnhwOUtqdUJ5UE10V3cwRnhvOEtwWm5vTVJwK2FLUDI3azNFWTlmelpjR09KIiwiY29uc2VudFRva2VuIjpudWxsLCJkZXZpY2VJZCI6ImFtem4xLmFzay5kZXZpY2UuQUZZQzRLQUhDR0xKSFlQUkUyWUdHUUpJNFlOUTIyNjJMMllJUFdPV0dDNlo0RTZRUDM0RERMUlNLNUlNVVJDVzVaSFFNWDY2U1FER0FSVU80RDJCM0tWWTdIVkFIM0lWN1lRRzVEWVJMTFJVNkFDV1NSV000VDJRUUxZSkJGMllXWlNQQ09GUEwyREZKRVJBTFRXTVQ2RU8zWERCN0hRSTNZRllXN0UzV1JMSllKQlRXRjc0TSIsInVzZXJJZCI6ImFtem4xLmFzay5hY2NvdW50LkFGT1JSVFRHNVhJSkUyQklKSUZCUkJUTkIyREJYNjYzSzZFUlE2R05NTkNRU01GN0g2SldMSzc0QU5BWFFFQlBYQ1lYQ05LSjZET0w2TFZMQTNVTlY3U1hTMjZFTzJESVJZNzYyTklDMkNBV0pQWU5LVTRHRkdMNkNCUEZCNkdKWEZZTFQyWkRSSkRERkg0RktPTko0NE5DSEU1RlRIS1dQUkgzWDdWWTdTSFNHQVVGU01ITFdPSDc2WlJCMkFWRUZMWFI3TDRVRFpCWVA1WSJ9fQ.RFErdnHOqG3DcX40JhGbNCNEUDyhwX94Sf98BMBkgzy83U_9zvBs1sW_3AfFz9OB_qYc5owSswySwQv5rqRshPA582C44F_1rnmHT9tta9eeXhC1KoIHyFXtsWQ5YtCRxWeZs5d5dw1UaR4gTwo3eJATSaDGDqsqMrl10XUwL_cbu7adXEu7Rjn2SXoiKdiD1YsBJMBF29NR0QLqQgAijA48tKgDpgWygEzjEdrjklR_WkHxp55C1Lgw0hqkBn2JV2PMtRAcOP6Cj9e7bOYc6YZSNmioVudhckwll07UQVX9f0SIs2fRqsNsEKDwr0TxW_QUTkcWJGR4tdjbDfE2DA\",\"unit\":{\"unitId\":\"amzn1.ask.unit.AG6CV5QW6HUW7MLLRUFR7ZVIIBJPUB4VGBNKJWPAOV2IARWLX34PJJMCH7BUUZSHTVWLVPZJ7VRYHDS63KSHI2DOJVRF6LXBZURNMVDLKKTG5Q4N2YP3X6BJABKAHR5Y3A\"}}},\"version\":\"1.0\",\"session\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"DENIED\"}}}},\"new\":true,\"sessionId\":\"amzn1.echo-api.session.2a6b38ac-b905-44b9-b99e-b81f14f87afe\"},\"request\":{\"requestId\":\"amzn1.echo-api.request.513dd21d-94e6-411f-9e59-4acebf7ea110\",\"locale\":\"it-IT\",\"intent\":{\"name\":\"RegionColorIntent\",\"confirmationStatus\":\"NONE\"},\"type\":\"IntentRequest\",\"timestamp\":\"2021-01-26T07:16:34Z\"}}"
            let result = eitherDecode d :: Either String AlexaRequest
            isRight result `shouldBe` True
            let Right message = result
            coordinate <$> (alexaGeolocation . context) message `shouldBe` Nothing
        it "can parse a message without geographic authorization but with grants" $ do
            let d = "{\"context\":{\"Extensions\":{\"available\":{}},\"System\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"device\":{\"supportedInterfaces\":{},\"deviceId\":\"amzn1.ask.device.AFYC4KAHCGLJHYPRE2YGGQJI4YNQ2262L2YIPWOWGC6Z4E6QP34DDLRSK5IMURCW5ZHQMX66SQDGARUO4D2B3KVY7HVAH3IV7YQG5DYRLLRU6ACWSRWM4T2QQLYJBF2YWZSPCOFPL2DFJERALTWMT6EO3XDB7HQI3YFYW7E3WRLJYJBTWF74M\"},\"apiEndpoint\":\"https://api.eu.amazonalexa.com\",\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"GRANTED\"}},\"consentToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTgyMzE5MywiaWF0IjoxNjExODE5NTkzLCJuYmYiOjE2MTE4MTk1OTMsInByaXZhdGVDbGFpbXMiOnsiaXNEZXByZWNhdGVkIjoidHJ1ZSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklEbkNfZDNwc3hVWEVLc080Z3NtTW5qV0xUY2N2X2hUWTBuNUVET2l1VTM4RUxoS095QzVRdTFiNHdyMWlTVVdsYmhnckVNVXpFdnI4YXh6NGJJVUVKejVRNllZSDBsa3FIMS1mXzl0SnBfRnJVZlF0RjhLeVFTLURXVGxjdnlOcHdUYmRnLWw0dTlOcmZtWmUtNzBsVVMwNGZqU1lJTWY4VXRNcWxoSzFfa0hQalFRamJmV2o3TlpXQjl2c25LUGNmNW93aTVndy1XVWNIanp3cXViRDJ2Wk1Na2l0S0J5OUVUS1E3cmJOaWlCY0tGWkpJY2QtajBLM0V3RVVaLV9yVlluN1ZuY3VqblVmSktFek9pdW4tMzlzWmJER3JRbXRtU2I4YXhOQnRZTTJRIiwiZGV2aWNlSWQiOiJhbXpuMS5hc2suZGV2aWNlLkFGWUM0S0FIQ0dMSkhZUFJFMllHR1FKSTRZTlEyMjYyTDJZSVBXT1dHQzZaNEU2UVAzNERETFJTSzVJTVVSQ1c1WkhRTVg2NlNRREdBUlVPNEQyQjNLVlk3SFZBSDNJVjdZUUc1RFlSTExSVTZBQ1dTUldNNFQyUVFMWUpCRjJZV1pTUENPRlBMMkRGSkVSQUxUV01UNkVPM1hEQjdIUUkzWUZZVzdFM1dSTEpZSkJUV0Y3NE0iLCJ1c2VySWQiOiJhbXpuMS5hc2suYWNjb3VudC5BRk9SUlRURzVYSUpFMkJJSklGQlJCVE5CMkRCWDY2M0s2RVJRNkdOTU5DUVNNRjdINkpXTEs3NEFOQVhRRUJQWENZWENOS0o2RE9MNkxWTEEzVU5WN1NYUzI2RU8yRElSWTc2Mk5JQzJDQVdKUFlOS1U0R0ZHTDZDQlBGQjZHSlhGWUxUMlpEUkpEREZINEZLT05KNDROQ0hFNUZUSEtXUFJIM1g3Vlk3U0hTR0FVRlNNSExXT0g3NlpSQjJBVkVGTFhSN0w0VURaQllQNVkifX0.TUOaJAz6hSthAWjnMFSOpPM_yVhBZibyuKX4AId2sPkzcLOp6poctB5VK7bWFTs5iYgppirtfQ1H4WnfU3JWNdG3AKJZxkJ0gjuCqsV2yRJNX1cCIP_pt6lfh4LVMHwemRS12X9zOG8XOXz6XwW4IGFZiYw9bErbuHLTEjf2RDFjA1oDWhDre_YZrMMb6TEdgAAKQUn6S0JW8zmqA1PhYTHA7N3e2w7GLmB4MUAjRXJPsrsSa6BIgQeoXY0QiGTYeVhMIK76BRjjTTOOItfouK5mDYP9kKn77VUAkK6GLvHaKT77S35c5LL_pv2Ly-OEv_pOgR6zmRtKEvmaKp7tEg\"}},\"apiAccessToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTgxOTg5MywiaWF0IjoxNjExODE5NTkzLCJuYmYiOjE2MTE4MTk1OTMsInByaXZhdGVDbGFpbXMiOnsiY29udGV4dCI6IkFBQUFBQUFBQVFEbldsWU1RRisxdnRQbU5reWJPamNrVHdFQUFBQUFBQURVeVhOdy9ybE04dE5uOTlsSFRobjA3RVpTVVA5NDR6ekNGR1ptNmlyTkdieXhLWFUzenhSTXZScEh0T0lrN1FRdEMxSmNLZjU0L2hnSUZ4a0t0ZnZlN0pNUTJpbUMvOHRCUGhxVGE2NDBXU2NYU3ZSOGZ3YUpkRXErZXk2K2tiWU92OVVOSUJycWJnVkpmbHlnZGxubjhkYllZejUrZUFoQVBUbzcrdlI1WVBGSmpPVmtGVHdjbnUzaXAxTVhvUS8zNHpxRlhWS2JHbURKdWFEcG1aall5VG9XblRrWEwxdE1Ld25HOHA3b1dwREo1MHpWRFpMbGRjUnhYQy9paFhRcGVBQmNGcDZaVTVNTk16WTRKU2lqV2xwTlNVVnhCTm1Da01rcE0zbjd1b29Xd3JSZTdhWkgxdS8rWkFMaGV4YXp0RDBSRnVHcXZxNENhV0x0eTV3MlZGb0wyMjMvcHZ0Y3FDc0xtR3Nab1l1bDVXT3hYTW9rM3FzcG5FNThIVWhiTlRPb2dCQVZtZUxJSVRxcHQ4ZmtxMGFHWXdzVFRpN0lmKzVnajdUVWM2YnhFQmpWM25kU0NyMHMweG1CMWc9PSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklEbkNfZDNwc3hVWEVLc080Z3NtTW5qV0xUY2N2X2hUWTBuNUVET2l1VTM4RUxoS095QzVRdTFiNHdyMWlTVVdsYmhnckVNVXpFdnI4YXh6NGJJVUVKejVRNllZSDBsa3FIMS1mXzl0SnBfRnJVZlF0RjhLeVFTLURXVGxjdnlOcHdUYmRnLWw0dTlOcmZtWmUtNzBsVVMwNGZqU1lJTWY4VXRNcWxoSzFfa0hQalFRamJmV2o3TlpXQjl2c25LUGNmNW93aTVndy1XVWNIanp3cXViRDJ2Wk1Na2l0S0J5OUVUS1E3cmJOaWlCY0tGWkpJY2QtajBLM0V3RVVaLV9yVlluN1ZuY3VqblVmSktFek9pdW4tMzlzWmJER3JRbXRtU2I4YXhOQnRZTTJRIiwiZGV2aWNlSWQiOiJhbXpuMS5hc2suZGV2aWNlLkFGWUM0S0FIQ0dMSkhZUFJFMllHR1FKSTRZTlEyMjYyTDJZSVBXT1dHQzZaNEU2UVAzNERETFJTSzVJTVVSQ1c1WkhRTVg2NlNRREdBUlVPNEQyQjNLVlk3SFZBSDNJVjdZUUc1RFlSTExSVTZBQ1dTUldNNFQyUVFMWUpCRjJZV1pTUENPRlBMMkRGSkVSQUxUV01UNkVPM1hEQjdIUUkzWUZZVzdFM1dSTEpZSkJUV0Y3NE0iLCJ1c2VySWQiOiJhbXpuMS5hc2suYWNjb3VudC5BRk9SUlRURzVYSUpFMkJJSklGQlJCVE5CMkRCWDY2M0s2RVJRNkdOTU5DUVNNRjdINkpXTEs3NEFOQVhRRUJQWENZWENOS0o2RE9MNkxWTEEzVU5WN1NYUzI2RU8yRElSWTc2Mk5JQzJDQVdKUFlOS1U0R0ZHTDZDQlBGQjZHSlhGWUxUMlpEUkpEREZINEZLT05KNDROQ0hFNUZUSEtXUFJIM1g3Vlk3U0hTR0FVRlNNSExXT0g3NlpSQjJBVkVGTFhSN0w0VURaQllQNVkifX0.lOg8_l-ijMQN3obKp9dQ0RuuTi54T3pKeZqucQhDH1J_C606CYN6X-Hi-or6BCYmZeOWDRW1kbmmXdUbt-fAnT0jlifjsvmvCVO0_cGW4sOxFy9nXDyaEKa35zqKQ6Ns2l-nzIQsPu8YOqbjAUjnI6R06FBZz56z7qZ3OtOwoZMQivWiCHmjAQISBguFtFYXSzfZw7KJ0a1ld5TwH3KtaYLse5c_JAfhOhxpignMTLZEs1j81h40HWxOvxH3uUC52mXjCuTyuPrHVdQabRHptJfRcKBUaPY2gZRioCEiZJXTk7Mpc4zOl9GMruhg85wbRuwwI33lmnyPE2y6aFCgQw\",\"unit\":{\"unitId\":\"amzn1.ask.unit.AG6CV5QW6HUW7MLLRUFR7ZVIIBJPUB4VGBNKJWPAOV2IARWLX34PJJMCH7BUUZSHTVWLVPZJ7VRYHDS63KSHI2DOJVRF6LXBZURNMVDLKKTG5Q4N2YP3X6BJABKAHR5Y3A\"}}},\"version\":\"1.0\",\"session\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"GRANTED\"}},\"consentToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTgyMzE5MywiaWF0IjoxNjExODE5NTkzLCJuYmYiOjE2MTE4MTk1OTMsInByaXZhdGVDbGFpbXMiOnsiaXNEZXByZWNhdGVkIjoidHJ1ZSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklEbkNfZDNwc3hVWEVLc080Z3NtTW5qV0xUY2N2X2hUWTBuNUVET2l1VTM4RUxoS095QzVRdTFiNHdyMWlTVVdsYmhnckVNVXpFdnI4YXh6NGJJVUVKejVRNllZSDBsa3FIMS1mXzl0SnBfRnJVZlF0RjhLeVFTLURXVGxjdnlOcHdUYmRnLWw0dTlOcmZtWmUtNzBsVVMwNGZqU1lJTWY4VXRNcWxoSzFfa0hQalFRamJmV2o3TlpXQjl2c25LUGNmNW93aTVndy1XVWNIanp3cXViRDJ2Wk1Na2l0S0J5OUVUS1E3cmJOaWlCY0tGWkpJY2QtajBLM0V3RVVaLV9yVlluN1ZuY3VqblVmSktFek9pdW4tMzlzWmJER3JRbXRtU2I4YXhOQnRZTTJRIiwiZGV2aWNlSWQiOiJhbXpuMS5hc2suZGV2aWNlLkFGWUM0S0FIQ0dMSkhZUFJFMllHR1FKSTRZTlEyMjYyTDJZSVBXT1dHQzZaNEU2UVAzNERETFJTSzVJTVVSQ1c1WkhRTVg2NlNRREdBUlVPNEQyQjNLVlk3SFZBSDNJVjdZUUc1RFlSTExSVTZBQ1dTUldNNFQyUVFMWUpCRjJZV1pTUENPRlBMMkRGSkVSQUxUV01UNkVPM1hEQjdIUUkzWUZZVzdFM1dSTEpZSkJUV0Y3NE0iLCJ1c2VySWQiOiJhbXpuMS5hc2suYWNjb3VudC5BRk9SUlRURzVYSUpFMkJJSklGQlJCVE5CMkRCWDY2M0s2RVJRNkdOTU5DUVNNRjdINkpXTEs3NEFOQVhRRUJQWENZWENOS0o2RE9MNkxWTEEzVU5WN1NYUzI2RU8yRElSWTc2Mk5JQzJDQVdKUFlOS1U0R0ZHTDZDQlBGQjZHSlhGWUxUMlpEUkpEREZINEZLT05KNDROQ0hFNUZUSEtXUFJIM1g3Vlk3U0hTR0FVRlNNSExXT0g3NlpSQjJBVkVGTFhSN0w0VURaQllQNVkifX0.TUOaJAz6hSthAWjnMFSOpPM_yVhBZibyuKX4AId2sPkzcLOp6poctB5VK7bWFTs5iYgppirtfQ1H4WnfU3JWNdG3AKJZxkJ0gjuCqsV2yRJNX1cCIP_pt6lfh4LVMHwemRS12X9zOG8XOXz6XwW4IGFZiYw9bErbuHLTEjf2RDFjA1oDWhDre_YZrMMb6TEdgAAKQUn6S0JW8zmqA1PhYTHA7N3e2w7GLmB4MUAjRXJPsrsSa6BIgQeoXY0QiGTYeVhMIK76BRjjTTOOItfouK5mDYP9kKn77VUAkK6GLvHaKT77S35c5LL_pv2Ly-OEv_pOgR6zmRtKEvmaKp7tEg\"}},\"new\":true,\"sessionId\":\"amzn1.echo-api.session.6a9a3cca-0716-4f64-9b42-ead4571e7acc\"},\"request\":{\"requestId\":\"amzn1.echo-api.request.9b0d9407-6138-431e-88f6-85f06168725d\",\"locale\":\"it-IT\",\"intent\":{\"name\":\"RegionColorIntent\",\"confirmationStatus\":\"NONE\"},\"type\":\"IntentRequest\",\"timestamp\":\"2021-01-28T07:39:53Z\"}}"
            let result = eitherDecode d :: Either String AlexaRequest
            isRight result `shouldBe` True
            let Right message = result
            coordinate <$> (alexaGeolocation . context) message `shouldBe` Nothing
        it "can parse a message without any authorization" $ do
            let d = "{\"context\":{\"Extensions\":{\"available\":{}},\"System\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"device\":{\"supportedInterfaces\":{},\"deviceId\":\"amzn1.ask.device.AFYC4KAHCGLJHYPRE2YGGQJI4YNQ2262L2YIPWOWGC6Z4E6QP34DDLRSK5IMURCW5ZHQMX66SQDGARUO4D2B3KVY7HVAH3IV7YQG5DYRLLRU6ACWSRWM4T2QQLYJBF2YWZSPCOFPL2DFJERALTWMT6EO3XDB7HQI3YFYW7E3WRLJYJBTWF74M\"},\"apiEndpoint\":\"https://api.eu.amazonalexa.com\",\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"DENIED\"}}}},\"apiAccessToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTkwMjUxNiwiaWF0IjoxNjExOTAyMjE2LCJuYmYiOjE2MTE5MDIyMTYsInByaXZhdGVDbGFpbXMiOnsiY29udGV4dCI6IkFBQUFBQUFBQVFCcFZNTlhPVzQ0VXdNNTFWYXBvMHIzS2dFQUFBQUFBQUR4cnBQanFTckhZYytvUW9oUDBSZ3lvd3YzdDVRUEZyZEdrWjFFMzZwSmZBZmhwNXoxQ1ZJUjRkMlROOUY0NlFpS3g4VFVHcjg3Mk9HSHZ3bUtIb2pkeW9kYXVuNUMrZ0RpVGtUemZjdmJMS1B0SHY3QW1zYWcxemNSNksxRzA4ZUpHNHFEQ3QrOFVpa0dNWWQ1T2MxSFpyc0pzUnlWc2Vvd3dQN1BqMDYzblRjQ0R0OUYrR2RkZlE2WGd5aEJPd3lpMWxsYWVDWlEwRXlHN21Oc29wR3VJdHhYdlROek9pK0x0OE9mNGVwdStHbWtCMCtDNTBaZENGa3B6TTBsL1FHRVBKeWJxcnM0UVpwMURCc2l2K1QwdHNEQiswYTFhUFV6UzRXbTlUM3ZBTE9VenpaZGRMQlBvR09ma1dtWVRLUytvUWgzUjdhcVVwRjFma1hsZmp0ekI5enZPWTZQdUh4RUtOdk5rWFdFRXc2NzNrZWxvanNEWVVCTmprNmxibmVQeUI2ZkR1RDNIbFZ6IiwiY29uc2VudFRva2VuIjpudWxsLCJkZXZpY2VJZCI6ImFtem4xLmFzay5kZXZpY2UuQUZZQzRLQUhDR0xKSFlQUkUyWUdHUUpJNFlOUTIyNjJMMllJUFdPV0dDNlo0RTZRUDM0RERMUlNLNUlNVVJDVzVaSFFNWDY2U1FER0FSVU80RDJCM0tWWTdIVkFIM0lWN1lRRzVEWVJMTFJVNkFDV1NSV000VDJRUUxZSkJGMllXWlNQQ09GUEwyREZKRVJBTFRXTVQ2RU8zWERCN0hRSTNZRllXN0UzV1JMSllKQlRXRjc0TSIsInVzZXJJZCI6ImFtem4xLmFzay5hY2NvdW50LkFGT1JSVFRHNVhJSkUyQklKSUZCUkJUTkIyREJYNjYzSzZFUlE2R05NTkNRU01GN0g2SldMSzc0QU5BWFFFQlBYQ1lYQ05LSjZET0w2TFZMQTNVTlY3U1hTMjZFTzJESVJZNzYyTklDMkNBV0pQWU5LVTRHRkdMNkNCUEZCNkdKWEZZTFQyWkRSSkRERkg0RktPTko0NE5DSEU1RlRIS1dQUkgzWDdWWTdTSFNHQVVGU01ITFdPSDc2WlJCMkFWRUZMWFI3TDRVRFpCWVA1WSJ9fQ.G5Q6F_KO_sfCl9NaeRxTc2s5M8Wf0-jcGssSyIAc4Khy1lZ3sa6mGRRvt1XLaskXRcPzu17UmpGIQrA5RGyzU2b8QcgRQXw-DebZtxHSkOhih3YlCY_ZiTDA9UuWx-aIj5Hqcg7S7VwMnd4K-TJ7oqMuawqQkf51hNlj241Apgv_hEF69gVCFIMuChaBQX9WSm2rwUX0iFDgLmVIvmyCn5ynfB8HSjprlreNp3bZahiPmoFZ8dibAvJjuWbs1PyTdOHESy3yENgWJ5gcwvK36JkWuDkSgnmyVRXQ9_Uh3kprk20XSWzesJTAjyqyUCRzcFd2VJLAQouk3qbxCwt9BQ\",\"unit\":{\"unitId\":\"amzn1.ask.unit.AG6CV5QW6HUW7MLLRUFR7ZVIIBJPUB4VGBNKJWPAOV2IARWLX34PJJMCH7BUUZSHTVWLVPZJ7VRYHDS63KSHI2DOJVRF6LXBZURNMVDLKKTG5Q4N2YP3X6BJABKAHR5Y3A\"}}},\"version\":\"1.0\",\"session\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"DENIED\"}}}},\"new\":true,\"sessionId\":\"amzn1.echo-api.session.a5e2b0ed-92af-4b68-bc4e-0c6fbef41e3d\"},\"request\":{\"requestId\":\"amzn1.echo-api.request.7bb3cb4c-0e19-4739-96a2-9a4ae00aa749\",\"locale\":\"it-IT\",\"intent\":{\"name\":\"RegionColorIntent\",\"confirmationStatus\":\"NONE\"},\"type\":\"IntentRequest\",\"timestamp\":\"2021-01-29T06:36:56Z\"}}"
            let result = eitherDecode d :: Either String AlexaRequest
            isRight result `shouldBe` True
            let Right message = result
            coordinate <$> (alexaGeolocation . context) message `shouldBe` Nothing
        it "can parse a message with the geographic location" $ do
            let d = "{\"context\":{\"Extensions\":{\"available\":{}},\"System\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"device\":{\"supportedInterfaces\":{\"Geolocation\":{}},\"deviceId\":\"amzn1.ask.device.AFYC4KAHCGLJHYPRE2YGGQJI4YNYM6BMPUD7QZBJXRZAL5ZMAUUO6TKCY4ZLXCOX6V7ZN2OSXR6I5D65DIH4TKI4OM35SI34Q7OISJ344UBRNBDZYSRXL5AZ7NJNLL4Q5QBP65FC3MOQYZ3LGGU265T6LJZB4UK5WZ7YO5RE4AHININL3ZCXA\"},\"apiEndpoint\":\"https://api.eu.amazonalexa.com\",\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"GRANTED\"}},\"consentToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTk5ODI0OSwiaWF0IjoxNjExOTk0NjQ5LCJuYmYiOjE2MTE5OTQ2NDksInByaXZhdGVDbGFpbXMiOnsiaXNEZXByZWNhdGVkIjoidHJ1ZSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklOVzdLcXd0VGtIUmxSSlI3OElGWXFILVZEY1NEYXpoUjZLRlRNLWxYa3RvTE8teW5Vd0RZQVQwNEwzOHFuOEx6Nlk1SGxZUk5ac01JWWtfNXBGT0d1NzdyM19iU0toQnRCb3JSUUZpMUVENlZyMzdNZjcwYUc3R3J6R3luVFQ4elFHMnJFR1FyOC14RTZpRS1NSDNKUk1YOXNMY19RQXcwbGF3THBoODdVWnNVbkt1aXBjaWFrWThYOHpoODRPb1FqQlY0d2RQS25QOHZndFcteWtRYjV1YkZwMFg5MVJSeTNNUlUwcTBaaTFXV0Jsdi1ZYllyam9GU3ZrMHdtUWI5SEFzaEoxZF9LcUFPdTFoQ09EUkw3RlVnSnJzak9CYk5DcDlyMGdBNUpIa0FVc2lZeXVlUkpVUDZ0T3MyMTdHNk11bFBsM2dDUUhMWG5CM3E0WEpyQ1BNR3JVMWNyaXlsNWttc0ZaMVM5dG0zQSIsImRldmljZUlkIjoiYW16bjEuYXNrLmRldmljZS5BRllDNEtBSENHTEpIWVBSRTJZR0dRSkk0WU5ZTTZCTVBVRDdRWkJKWFJaQUw1Wk1BVVVPNlRLQ1k0WkxYQ09YNlY3Wk4yT1NYUjZJNUQ2NURJSDRUS0k0T00zNVNJMzRRN09JU0ozNDRVQlJOQkRaWVNSWEw1QVo3TkpOTEw0UTVRQlA2NUZDM01PUVlaM0xHR1UyNjVUNkxKWkI0VUs1V1o3WU81UkU0QUhJTklOTDNaQ1hBIiwidXNlcklkIjoiYW16bjEuYXNrLmFjY291bnQuQUZPUlJUVEc1WElKRTJCSUpJRkJSQlROQjJEQlg2NjNLNkVSUTZHTk1OQ1FTTUY3SDZKV0xLNzRBTkFYUUVCUFhDWVhDTktKNkRPTDZMVkxBM1VOVjdTWFMyNkVPMkRJUlk3NjJOSUMyQ0FXSlBZTktVNEdGR0w2Q0JQRkI2R0pYRllMVDJaRFJKRERGSDRGS09OSjQ0TkNIRTVGVEhLV1BSSDNYN1ZZN1NIU0dBVUZTTUhMV09INzZaUkIyQVZFRkxYUjdMNFVEWkJZUDVZIn19.NTcOCW-71QAuxTIS8IRiaCtWmStR-1n3pNMVJYKnztv3bBVEQzHZdNT8f11EAxQItXVp3AKSHAswPphytNmyxRi5ddC9QB2XVAsQygzq2UeZW5WEAa20kWo26JtqUe9w68qpCXUq81htQY2zWxHhPYG2arkxaiddEkDGfkip8CMb3wBN9dl-AePCEmnDXj7cZePLwMgRf_wDbNv2VR4GHN2G8gDMI5cvKc0Au4aF_kmjNk9DotfyjfAITHCHc2Fs-wzUZ3LKuBye_lY1hA__pwI0OEod8dcIYwcGt31UbrfdH1feqFcZIv5phKG-zHVb7Pc5Xxta9bo3I2757y-vnA\"}},\"apiAccessToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTk5NDk0OSwiaWF0IjoxNjExOTk0NjQ5LCJuYmYiOjE2MTE5OTQ2NDksInByaXZhdGVDbGFpbXMiOnsiY29udGV4dCI6IkFBQUFBQUFBQVFCQXQwU3RmbjVYUTBXaFdqR0t2SWptaUFFQUFBQUFBQUJwQWExZ1V5cGpnMEJBa29EQzZ2d3dvZzcycWNWdFEwRVR1MWkxY1ZDUXB1TVFmVzl1Q0ZvY1ZCSTM1ekJRWld4L1A4akJYVFR5eHhmWG4xNDJSaThncldQK3g4QUdUcWl0TWV4NHFLR1BHZEo2Vm0rVXViOXJRa2RrcVNvYW1HSkFGb01xcjc0RVV2cDlXR3JYWjk4cUVZSjBoN3JRN2tZdDJ1bFNJLzhCTWlYWDk1cmR3Qkg4cEpHbGRrYTdPSExON0R1b2VlSC9KTUQ1VzlzUURZVFR0ZkRsTlNxZmM4TVArRGpIL3lqcGdHdTcrUjlod2pxclg1cHplUVlZYW9kU3p5ZGcydll5b09Tdjh1MGlma2t2bEhYcnB4c3g5UHZXMFJ4ZXJYcHExSWkyMVFrc0JGNlJDblBYWFBQejdTTnI0Wm91SmpFZkJTTFF1MkNrWFk5VVVZcmlQOFZMb0VrTmlaSXRLdEgrNFY5WThxYnhvQVNiSFlyQjBJWW4wa1dsdGljd3NpSHIxM2JuK3UwR1BCTmNtbGtuWWJhUzR3VWUxVzhwVlJpY3VRek1IeHJSdHlPRk1JZDVEY0xlTTVTWU1VYkJ6TnhyOW8vclB4dnVDVzNUa0pBTGwwL0RpR1pDUkZIOVN6eUZETDI5bm51MjcyN1dPUWswUTB4NkhpZEN5L2ljOVZ5SGd3PT0iLCJjb25zZW50VG9rZW4iOiJBdHphfEl3RUJJTlc3S3F3dFRrSFJsUkpSNzhJRllxSC1WRGNTRGF6aFI2S0ZUTS1sWGt0b0xPLXluVXdEWUFUMDRMMzhxbjhMejZZNUhsWVJOWnNNSVlrXzVwRk9HdTc3cjNfYlNLaEJ0Qm9yUlFGaTFFRDZWcjM3TWY3MGFHN0dyekd5blRUOHpRRzJyRUdRcjgteEU2aUUtTUgzSlJNWDlzTGNfUUF3MGxhd0xwaDg3VVpzVW5LdWlwY2lha1k4WDh6aDg0T29RakJWNHdkUEtuUDh2Z3RXLXlrUWI1dWJGcDBYOTFSUnkzTVJVMHEwWmkxV1dCbHYtWWJZcmpvRlN2azB3bVFiOUhBc2hKMWRfS3FBT3UxaENPRFJMN0ZVZ0pyc2pPQmJOQ3A5cjBnQTVKSGtBVXNpWXl1ZVJKVVA2dE9zMjE3RzZNdWxQbDNnQ1FITFhuQjNxNFhKckNQTUdyVTFjcml5bDVrbXNGWjFTOXRtM0EiLCJkZXZpY2VJZCI6ImFtem4xLmFzay5kZXZpY2UuQUZZQzRLQUhDR0xKSFlQUkUyWUdHUUpJNFlOWU02Qk1QVUQ3UVpCSlhSWkFMNVpNQVVVTzZUS0NZNFpMWENPWDZWN1pOMk9TWFI2STVENjVESUg0VEtJNE9NMzVTSTM0UTdPSVNKMzQ0VUJSTkJEWllTUlhMNUFaN05KTkxMNFE1UUJQNjVGQzNNT1FZWjNMR0dVMjY1VDZMSlpCNFVLNVdaN1lPNVJFNEFISU5JTkwzWkNYQSIsInVzZXJJZCI6ImFtem4xLmFzay5hY2NvdW50LkFGT1JSVFRHNVhJSkUyQklKSUZCUkJUTkIyREJYNjYzSzZFUlE2R05NTkNRU01GN0g2SldMSzc0QU5BWFFFQlBYQ1lYQ05LSjZET0w2TFZMQTNVTlY3U1hTMjZFTzJESVJZNzYyTklDMkNBV0pQWU5LVTRHRkdMNkNCUEZCNkdKWEZZTFQyWkRSSkRERkg0RktPTko0NE5DSEU1RlRIS1dQUkgzWDdWWTdTSFNHQVVGU01ITFdPSDc2WlJCMkFWRUZMWFI3TDRVRFpCWVA1WSJ9fQ.Wgd8pfaBMsi6osJ8SzNK1CFbtfrhhxoNbZGy7xJqvnGSWKiLCwZ-rIqVUPBBz6-CtbE-qHx6n8fONQV4TVSB2v4DqK3R4A-mbv9XCjjpTLnmL-dF-68XTBSd2XqpJuabUYUSmit73pK3Q5grhfhMEfFUAe4try6EwlDvGJTlj2-XJof3Uo4rjVt1UYVrjHAq3HBFrwL1uLZsWJpVuBVVLx1htKw9LVUEKIrmP8r9mRdbw86tRQUsY-RpEDs17O115Rva5CS-nQjBa0u1Qh2IctAEg_VKOJgEU61M3w-ufATLzcJeta7wV_lktsJyvhLEYJB4yZ1HkxKcMgThxqaOSA\"},\"Geolocation\":{\"heading\":{\"directionInDegrees\":0.0},\"locationServices\":{\"access\":\"ENABLED\",\"status\":\"RUNNING\"},\"speed\":{\"speedInMetersPerSecond\":0.0},\"coordinate\":{\"accuracyInMeters\":20.0,\"latitudeInDegrees\":43.8377699,\"longitudeInDegrees\":10.6334343},\"altitude\":{\"altitudeInMeters\":69.9000015258789,\"accuracyInMeters\":20.0},\"timestamp\":\"2021-01-30T08:17:07Z\"}},\"version\":\"1.0\",\"session\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"GRANTED\"}},\"consentToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMTk5ODI0OSwiaWF0IjoxNjExOTk0NjQ5LCJuYmYiOjE2MTE5OTQ2NDksInByaXZhdGVDbGFpbXMiOnsiaXNEZXByZWNhdGVkIjoidHJ1ZSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklOVzdLcXd0VGtIUmxSSlI3OElGWXFILVZEY1NEYXpoUjZLRlRNLWxYa3RvTE8teW5Vd0RZQVQwNEwzOHFuOEx6Nlk1SGxZUk5ac01JWWtfNXBGT0d1NzdyM19iU0toQnRCb3JSUUZpMUVENlZyMzdNZjcwYUc3R3J6R3luVFQ4elFHMnJFR1FyOC14RTZpRS1NSDNKUk1YOXNMY19RQXcwbGF3THBoODdVWnNVbkt1aXBjaWFrWThYOHpoODRPb1FqQlY0d2RQS25QOHZndFcteWtRYjV1YkZwMFg5MVJSeTNNUlUwcTBaaTFXV0Jsdi1ZYllyam9GU3ZrMHdtUWI5SEFzaEoxZF9LcUFPdTFoQ09EUkw3RlVnSnJzak9CYk5DcDlyMGdBNUpIa0FVc2lZeXVlUkpVUDZ0T3MyMTdHNk11bFBsM2dDUUhMWG5CM3E0WEpyQ1BNR3JVMWNyaXlsNWttc0ZaMVM5dG0zQSIsImRldmljZUlkIjoiYW16bjEuYXNrLmRldmljZS5BRllDNEtBSENHTEpIWVBSRTJZR0dRSkk0WU5ZTTZCTVBVRDdRWkJKWFJaQUw1Wk1BVVVPNlRLQ1k0WkxYQ09YNlY3Wk4yT1NYUjZJNUQ2NURJSDRUS0k0T00zNVNJMzRRN09JU0ozNDRVQlJOQkRaWVNSWEw1QVo3TkpOTEw0UTVRQlA2NUZDM01PUVlaM0xHR1UyNjVUNkxKWkI0VUs1V1o3WU81UkU0QUhJTklOTDNaQ1hBIiwidXNlcklkIjoiYW16bjEuYXNrLmFjY291bnQuQUZPUlJUVEc1WElKRTJCSUpJRkJSQlROQjJEQlg2NjNLNkVSUTZHTk1OQ1FTTUY3SDZKV0xLNzRBTkFYUUVCUFhDWVhDTktKNkRPTDZMVkxBM1VOVjdTWFMyNkVPMkRJUlk3NjJOSUMyQ0FXSlBZTktVNEdGR0w2Q0JQRkI2R0pYRllMVDJaRFJKRERGSDRGS09OSjQ0TkNIRTVGVEhLV1BSSDNYN1ZZN1NIU0dBVUZTTUhMV09INzZaUkIyQVZFRkxYUjdMNFVEWkJZUDVZIn19.NTcOCW-71QAuxTIS8IRiaCtWmStR-1n3pNMVJYKnztv3bBVEQzHZdNT8f11EAxQItXVp3AKSHAswPphytNmyxRi5ddC9QB2XVAsQygzq2UeZW5WEAa20kWo26JtqUe9w68qpCXUq81htQY2zWxHhPYG2arkxaiddEkDGfkip8CMb3wBN9dl-AePCEmnDXj7cZePLwMgRf_wDbNv2VR4GHN2G8gDMI5cvKc0Au4aF_kmjNk9DotfyjfAITHCHc2Fs-wzUZ3LKuBye_lY1hA__pwI0OEod8dcIYwcGt31UbrfdH1feqFcZIv5phKG-zHVb7Pc5Xxta9bo3I2757y-vnA\"}},\"new\":true,\"sessionId\":\"amzn1.echo-api.session.d7f5f5d8-d55f-486e-8855-a0b08f07689e\"},\"request\":{\"requestId\":\"amzn1.echo-api.request.c4d7512b-ea4a-44f8-a4ee-c61aba8598a7\",\"locale\":\"it-IT\",\"intent\":{\"name\":\"RegionColorIntent\",\"confirmationStatus\":\"NONE\"},\"type\":\"IntentRequest\",\"timestamp\":\"2021-01-30T08:17:31Z\"}}"
            let result = eitherDecode d :: Either String AlexaRequest
            isRight result `shouldBe` True
        it "can parse a message with a specific region request" $ do
            let d = "{\"context\":{\"Viewport\":{\"currentPixelWidth\":1024,\"dpi\":160,\"mode\":\"HUB\",\"video\":{\"codecs\":[\"H_264_42\",\"H_264_41\"]},\"shape\":\"RECTANGLE\",\"pixelHeight\":600,\"touch\":[\"SINGLE\"],\"experiences\":[{\"canRotate\":false,\"canResize\":false,\"arcMinuteHeight\":144,\"arcMinuteWidth\":246}],\"currentPixelHeight\":600,\"pixelWidth\":1024},\"Extensions\":{\"available\":{\"aplext:backstack:10\":{}}},\"System\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"device\":{\"supportedInterfaces\":{},\"deviceId\":\"amzn1.ask.device.AFYC4KAHCGLJHYPRE2YGGQJI4YNUYBQR3CB5A2HGXIB6Z34VV6ONHKBSM4SLVQ7JZDIG6JGKGMPETFTYKIROLCB6TFLZRHNVSWDJQJ2X6QIHVUQZ5CBVXCGUGSX4FRLRQDM5JIVWX3HCESJY2RY5PR4HSAW7VINTAMZKRVF2XJ5KLQPV36HBI\"},\"apiEndpoint\":\"https://api.eu.amazonalexa.com\",\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"GRANTED\"}},\"consentToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMjAxNzE1NSwiaWF0IjoxNjEyMDEzNTU1LCJuYmYiOjE2MTIwMTM1NTUsInByaXZhdGVDbGFpbXMiOnsiaXNEZXByZWNhdGVkIjoidHJ1ZSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklFaENLbTNUSnVWU1pRaTdrREEyWml2eEdUemxkTmVOd2FnYS0tdXVXSzBGX2FYa1NfdkZFakFiSmFIRVlaSnRBZ1BObnlkbzJGc3o0TjZrVDByX2dRT0xVNTFCbHc3ZGd3c3dhNGlvbFEzNDV2ZW5pUHBOMUZJZXdWMzR4ZnZDV0FMRUNJZnJ5OXZxOTR2cDc2c08tOUxONUdQYkhZU0pQRDREZ0hITmNkWGVpUjY3YjE2Yk1zVnNEcDFEc2ZKc2hZeEdfQjAtWjA4Z3JhU3NoVjFtbTRHS0hPdDF6QTVvRENsUjJNMXpKUUZGbng0a2dTOHJiTXVGeEdRbWNUMHhVYXMtRV9iWmw0dEl5bU11T2k1bS1uclAzSWRubnhiWmFuUVROUnFNTThLQTFPNmRWdVJjWlh1QTg5MTRKRWQ0aC1TVE1uQjVKRjNyeXRZbVdGNGJKWUxIdWxUa2RETEhMTURZZVpfSURGUk15ZyIsImRldmljZUlkIjoiYW16bjEuYXNrLmRldmljZS5BRllDNEtBSENHTEpIWVBSRTJZR0dRSkk0WU5VWUJRUjNDQjVBMkhHWElCNlozNFZWNk9OSEtCU000U0xWUTdKWkRJRzZKR0tHTVBFVEZUWUtJUk9MQ0I2VEZMWlJITlZTV0RKUUoyWDZRSUhWVVFaNUNCVlhDR1VHU1g0RlJMUlFETTVKSVZXWDNIQ0VTSlkyUlk1UFI0SFNBVzdWSU5UQU1aS1JWRjJYSjVLTFFQVjM2SEJJIiwidXNlcklkIjoiYW16bjEuYXNrLmFjY291bnQuQUZPUlJUVEc1WElKRTJCSUpJRkJSQlROQjJEQlg2NjNLNkVSUTZHTk1OQ1FTTUY3SDZKV0xLNzRBTkFYUUVCUFhDWVhDTktKNkRPTDZMVkxBM1VOVjdTWFMyNkVPMkRJUlk3NjJOSUMyQ0FXSlBZTktVNEdGR0w2Q0JQRkI2R0pYRllMVDJaRFJKRERGSDRGS09OSjQ0TkNIRTVGVEhLV1BSSDNYN1ZZN1NIU0dBVUZTTUhMV09INzZaUkIyQVZFRkxYUjdMNFVEWkJZUDVZIn19.N7w-PAKnugCibKByJmFN-CPLmquxHZOHV3sMCpEcYMUO96b6-VB7LpxH4p6gEWZvrB28oO7FE3-1YEwBo4p0c0kJcip6vM_fPKwq1z1gbuHfffbzqFFjJyPMHxhgaLeipBG1cIozIHxPL4lLu74LvS8CUTMxxbH2B1SM9BHuHNiZAaUG_O8Zwicc01ZE_qR0Bt3lD7zquqPQo_uP99QJWhgXs0YPj_V7tg8Yvzrh6Ji3O8oOTeW2DvbMTbSb-Meh7Lg0vbUPC-p5VMDGiTrdjLmIKfq0DeHVdPs1MgJ06eg1wgP5e9DRC3JHIFIn4u-nWZ0j_gD4nJEDix1ageSgnQ\"}},\"apiAccessToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMjAxMzg1NSwiaWF0IjoxNjEyMDEzNTU1LCJuYmYiOjE2MTIwMTM1NTUsInByaXZhdGVDbGFpbXMiOnsiY29udGV4dCI6IkFBQUFBQUFBQVFCQXQwU3RmbjVYUTBXaFdqR0t2SWptaUFFQUFBQUFBQUNXbTRNWmVRekdoZUpMQzVzY3JVMEhnOElGZlp0UUkvYm50N05uWlhrUHY0RTJBTFhaSnhYeW1BUU9QOHZOaWhZclA1eFFBamRkTVUza3lVcVRPdmJHTDNTZEZBWUxlS0dnR1AyR1ZFdyszamRoSy9LUjkvL1RBM1Z4b1pHK0VjTXZTNmF3b3gyWUJMTjZmYlV5NW53VFJzT2RuL3hTYW5nQlZlaGNIalVET1FGZ0YrY3JZVlpTUUprUmVDZnVMdkVPcUdlSWk3dHFJVzJSQ1RJcW1KaThMNU16WHdLQXRUekNHVlgyeW44My9RQVR6MzdGTFpvY2tVWHFOZzFoeFl3dGhyakxkUWg2WTAyYUg0NUlQTDlJR3V0ZnZxWWtJelNvdnNoYWlCMFBmcW83Z3NpRWhScktDeEpKaEVPSUNkWjVMdTFBWTJmVG45M0hUVCtNRHl5SllqbTN5c1UvWnNqUmpvUGlYZ1ZJYU5vdTFQZXJrWWdLeVRhbit4Q25qR0VuS1BjNW5nR0NneG5pcmllRkQwRlVNVFZidy81M085SEhGbU1DK2t4NjN5Y1NFOHM0dTRCWUFLRE5qSFFNRjRvMHc4L1pBNFQ5bXFzQUJOZVVpdDFJNWF2VXNHYUQ4L053MEQ0WVNPZ1hSVnZyZzZ6ckh2cDMxZ0lWVGhiRHpsbG12OGNIcTBBd3hnPT0iLCJjb25zZW50VG9rZW4iOiJBdHphfEl3RUJJRWhDS20zVEp1VlNaUWk3a0RBMlppdnhHVHpsZE5lTndhZ2EtLXV1V0swRl9hWGtTX3ZGRWpBYkphSEVZWkp0QWdQTm55ZG8yRnN6NE42a1Qwcl9nUU9MVTUxQmx3N2Rnd3N3YTRpb2xRMzQ1dmVuaVBwTjFGSWV3VjM0eGZ2Q1dBTEVDSWZyeTl2cTk0dnA3NnNPLTlMTjVHUGJIWVNKUEQ0RGdISE5jZFhlaVI2N2IxNmJNc1ZzRHAxRHNmSnNoWXhHX0IwLVowOGdyYVNzaFYxbW00R0tIT3QxekE1b0RDbFIyTTF6SlFGRm54NGtnUzhyYk11RnhHUW1jVDB4VWFzLUVfYlpsNHRJeW1NdU9pNW0tbnJQM0lkbm54YlphblFUTlJxTU04S0ExTzZkVnVSY1pYdUE4OTE0SkVkNGgtU1RNbkI1SkYzcnl0WW1XRjRiSllMSHVsVGtkRExITE1EWWVaX0lERlJNeWciLCJkZXZpY2VJZCI6ImFtem4xLmFzay5kZXZpY2UuQUZZQzRLQUhDR0xKSFlQUkUyWUdHUUpJNFlOVVlCUVIzQ0I1QTJIR1hJQjZaMzRWVjZPTkhLQlNNNFNMVlE3SlpESUc2SkdLR01QRVRGVFlLSVJPTENCNlRGTFpSSE5WU1dESlFKMlg2UUlIVlVRWjVDQlZYQ0dVR1NYNEZSTFJRRE01SklWV1gzSENFU0pZMlJZNVBSNEhTQVc3VklOVEFNWktSVkYyWEo1S0xRUFYzNkhCSSIsInVzZXJJZCI6ImFtem4xLmFzay5hY2NvdW50LkFGT1JSVFRHNVhJSkUyQklKSUZCUkJUTkIyREJYNjYzSzZFUlE2R05NTkNRU01GN0g2SldMSzc0QU5BWFFFQlBYQ1lYQ05LSjZET0w2TFZMQTNVTlY3U1hTMjZFTzJESVJZNzYyTklDMkNBV0pQWU5LVTRHRkdMNkNCUEZCNkdKWEZZTFQyWkRSSkRERkg0RktPTko0NE5DSEU1RlRIS1dQUkgzWDdWWTdTSFNHQVVGU01ITFdPSDc2WlJCMkFWRUZMWFI3TDRVRFpCWVA1WSJ9fQ.O7FYWNHPSWdzwsktnbFg7XO-gFmPubTAdTQX12k_mQUdfQcnqisdHHtCIztr4NI4AvkfDedjRE4RZb2ElfvvN-Lhob45jk2hi2Py5bEdT2G7R6VMx4uHn-qZ372e2zbuZ0uX0z1wSbqqez64zo_8-KtscGssVPJ191-5MQGpRDvLudqK0mzIcvLtkFfzFosJW9WOy1OUZFUUKw3RQSjVr7zhQSXsmzqGmQV_-eJiT6n0hKbFyu0MU-wjDbMUagLRCs4G-dwMb4sWnMm8vlrLkpB3vWO2HD-zL5WaMzPey8XjBR08-Ko7QOMV5DsZIlgylqyMO2_GRQaD36ekwYtRdw\"},\"Viewports\":[{\"dpi\":160,\"canRotate\":false,\"shape\":\"RECTANGLE\",\"id\":\"main\",\"type\":\"APL\",\"configuration\":{\"current\":{\"size\":{\"pixelHeight\":600,\"type\":\"DISCRETE\",\"pixelWidth\":1024},\"mode\":\"HUB\",\"video\":{\"codecs\":[\"H_264_42\",\"H_264_41\"]}}},\"presentationType\":\"STANDARD\"}]},\"version\":\"1.0\",\"session\":{\"application\":{\"applicationId\":\"amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de\"},\"user\":{\"userId\":\"amzn1.ask.account.AFORRTTG5XIJE2BIJIFBRBTNB2DBX663K6ERQ6GNMNCQSMF7H6JWLK74ANAXQEBPXCYXCNKJ6DOL6LVLA3UNV7SXS26EO2DIRY762NIC2CAWJPYNKU4GFGL6CBPFB6GJXFYLT2ZDRJDDFH4FKONJ44NCHE5FTHKWPRH3X7VY7SHSGAUFSMHLWOH76ZRB2AVEFLXR7L4UDZBYP5Y\",\"permissions\":{\"scopes\":{\"alexa::devices:all:geolocation:read\":{\"status\":\"GRANTED\"}},\"consentToken\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjViM2UxNmNiLTY2MGQtNDRkYS04YjBlLTc2OGNhYThkMjJkZSIsImV4cCI6MTYxMjAxNzE1NSwiaWF0IjoxNjEyMDEzNTU1LCJuYmYiOjE2MTIwMTM1NTUsInByaXZhdGVDbGFpbXMiOnsiaXNEZXByZWNhdGVkIjoidHJ1ZSIsImNvbnNlbnRUb2tlbiI6IkF0emF8SXdFQklFaENLbTNUSnVWU1pRaTdrREEyWml2eEdUemxkTmVOd2FnYS0tdXVXSzBGX2FYa1NfdkZFakFiSmFIRVlaSnRBZ1BObnlkbzJGc3o0TjZrVDByX2dRT0xVNTFCbHc3ZGd3c3dhNGlvbFEzNDV2ZW5pUHBOMUZJZXdWMzR4ZnZDV0FMRUNJZnJ5OXZxOTR2cDc2c08tOUxONUdQYkhZU0pQRDREZ0hITmNkWGVpUjY3YjE2Yk1zVnNEcDFEc2ZKc2hZeEdfQjAtWjA4Z3JhU3NoVjFtbTRHS0hPdDF6QTVvRENsUjJNMXpKUUZGbng0a2dTOHJiTXVGeEdRbWNUMHhVYXMtRV9iWmw0dEl5bU11T2k1bS1uclAzSWRubnhiWmFuUVROUnFNTThLQTFPNmRWdVJjWlh1QTg5MTRKRWQ0aC1TVE1uQjVKRjNyeXRZbVdGNGJKWUxIdWxUa2RETEhMTURZZVpfSURGUk15ZyIsImRldmljZUlkIjoiYW16bjEuYXNrLmRldmljZS5BRllDNEtBSENHTEpIWVBSRTJZR0dRSkk0WU5VWUJRUjNDQjVBMkhHWElCNlozNFZWNk9OSEtCU000U0xWUTdKWkRJRzZKR0tHTVBFVEZUWUtJUk9MQ0I2VEZMWlJITlZTV0RKUUoyWDZRSUhWVVFaNUNCVlhDR1VHU1g0RlJMUlFETTVKSVZXWDNIQ0VTSlkyUlk1UFI0SFNBVzdWSU5UQU1aS1JWRjJYSjVLTFFQVjM2SEJJIiwidXNlcklkIjoiYW16bjEuYXNrLmFjY291bnQuQUZPUlJUVEc1WElKRTJCSUpJRkJSQlROQjJEQlg2NjNLNkVSUTZHTk1OQ1FTTUY3SDZKV0xLNzRBTkFYUUVCUFhDWVhDTktKNkRPTDZMVkxBM1VOVjdTWFMyNkVPMkRJUlk3NjJOSUMyQ0FXSlBZTktVNEdGR0w2Q0JQRkI2R0pYRllMVDJaRFJKRERGSDRGS09OSjQ0TkNIRTVGVEhLV1BSSDNYN1ZZN1NIU0dBVUZTTUhMV09INzZaUkIyQVZFRkxYUjdMNFVEWkJZUDVZIn19.N7w-PAKnugCibKByJmFN-CPLmquxHZOHV3sMCpEcYMUO96b6-VB7LpxH4p6gEWZvrB28oO7FE3-1YEwBo4p0c0kJcip6vM_fPKwq1z1gbuHfffbzqFFjJyPMHxhgaLeipBG1cIozIHxPL4lLu74LvS8CUTMxxbH2B1SM9BHuHNiZAaUG_O8Zwicc01ZE_qR0Bt3lD7zquqPQo_uP99QJWhgXs0YPj_V7tg8Yvzrh6Ji3O8oOTeW2DvbMTbSb-Meh7Lg0vbUPC-p5VMDGiTrdjLmIKfq0DeHVdPs1MgJ06eg1wgP5e9DRC3JHIFIn4u-nWZ0j_gD4nJEDix1ageSgnQ\"}},\"new\":true,\"sessionId\":\"amzn1.echo-api.session.c02312e6-cdca-4e44-bb6a-7817918568a6\"},\"request\":{\"requestId\":\"amzn1.echo-api.request.ac26e7ec-c9c1-4383-aadd-17d81a30f7af\",\"locale\":\"it-IT\",\"intent\":{\"slots\":{\"region\":{\"resolutions\":{\"resolutionsPerAuthority\":[{\"status\":{\"code\":\"ER_SUCCESS_MATCH\"},\"values\":[{\"value\":{\"name\":\"Abruzzo\",\"id\":\"c22e8aefd0015bcf4e8fd333d1ad4f27\"}}],\"authority\":\"amzn1.er-authority.echo-sdk.amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de.LIST_OF_REGIONS\"}]},\"value\":\"abruzzo\",\"name\":\"region\",\"slotValue\":{\"resolutions\":{\"resolutionsPerAuthority\":[{\"status\":{\"code\":\"ER_SUCCESS_MATCH\"},\"values\":[{\"value\":{\"name\":\"Abruzzo\",\"id\":\"c22e8aefd0015bcf4e8fd333d1ad4f27\"}}],\"authority\":\"amzn1.er-authority.echo-sdk.amzn1.ask.skill.5b3e16cb-660d-44da-8b0e-768caa8d22de.LIST_OF_REGIONS\"}]},\"value\":\"abruzzo\",\"type\":\"Simple\"},\"source\":\"USER\",\"confirmationStatus\":\"NONE\"}},\"name\":\"ArbitraryRegionColorIntent\",\"confirmationStatus\":\"NONE\"},\"type\":\"IntentRequest\",\"timestamp\":\"2021-01-30T13:32:35Z\"}}"
            let result = eitherDecode d :: Either String AlexaRequest
            isRight result `shouldBe` True
